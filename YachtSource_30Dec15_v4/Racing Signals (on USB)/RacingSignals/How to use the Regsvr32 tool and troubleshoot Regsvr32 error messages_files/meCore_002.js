(function(n){function o(r){function tt(){var n=o.authenticatedState;w=n==u.SignedIn||n==u.SignedInIdp}function it(){var n;return n=o.enabled?w?"statussignedin":"statussignedout":"statusunavailable",t.getString(n)}function d(n){n.preventDefault(),n.stopPropagation(),o.enabled&&r.onSwitchUser&&r.onSwitchUser()}function g(i){i.preventDefault(),i.stopPropagation(),o.enabled&&(c.hide(),y.show(),p.text(t.getString(w?"statussigningout":"statusremoving")),o.onSignOutUser&&o.onSignOutUser(function(){n(l).trigger("remove")},function(){c.show(),y.hide(),p.text(t.getString(w?"statussignoutfailed":"statusremovingfailed"))}))}function nt(n,t){t&&n&&n.which===13&&t(n)}var l=this,a=!1,v=!1,o=r,k="msame_ai"+e++,h=null,s=null,b=null,y=null,c=null,p=null,w=null;l.render=function(){var n=i.PictureLoaderCache.isCached(o.tileUrl)?o.tileUrl:"";return t.format(f,k,n,t.encodeHtml(o.displayName),t.encodeHtml(o.memberName),t.encodeHtml(it()),t.getString(o.authenticatedState==u.SignedInIdp?"signoutremovetip":"removetip",!0),o.removeImgUrl)},l.activate=function(){if(!a&&!v){a=!0,s=n("#"+k),c=n(".msame_Drop_AI_remove",s),y=n(".msame_Drop_AI_prog",s),b=n(".msame_Drop_AI_piccont img",s),p=n(".msame_Drop_AI_status",s),s.toggleClass("disabled",!o.enabled),s.toggleClass("switch",o.enabled),h=new i.PictureLoader(b,o.tileUrl,o.errorImgUrl),setTimeout(h.activate,0);s.on("click",d);s.on("keydown",function(n){nt(n,d)});c.on("click",g);c.on("keydown",function(n){nt(n,g)})}},l.deactivate=function(){a&&!v&&(a=!1,h&&h.deactivate(),c.off())},l.dispose=function(){v||(l.deactivate(),h&&h.dispose(),s.remove(),o=r=h=null,s=c=b=y=p=null,v=!0)},tt()}var r=window;r.MSA=r.MSA||{};var i=r.MSA.MeControl=r.MSA.MeControl||{},t=i.Strings,u=i.AuthState,f='<div id="{0}" class="msame_Drop_AI switch" tabIndex="0"><div class="msame_Drop_AI_pic"><div class="msame_Drop_AI_piccont"><div class="msame_Drop_AI_picframe"><img role="presentation" src="{1}"><\/div><\/div><\/div><div class="msame_Drop_AI_right"><div class="msame_TxtTrunc msame_Drop_AI_name">{2}<\/div><div class="msame_TxtTrunc msame_Drop_AI_email">{3}<\/div><div class="msame_TxtTrunc msame_Drop_AI_status">{4}<\/div><\/div><div class="msame_Drop_AI_remove" tabIndex="0"><img alt="{5}" src="{6}" /><\/div><div class="msame_Drop_AI_prog" style="display:none;"><\/div><\/div>',e=0;i.AccountItemControl=o})(window.MejQuery),function(n){function f(t,f){function v(){if(c)for(var n=0;n<c.length;n++)e.push(new i.AccountItemControl(f.getAccountItemData(c[n])))}function y(t){var i=e.indexOf(t);t.dispose(),e.splice(i,1),n(t).off("remove"),e.length===0&&n(o).trigger("empty")}var o=this,s=!1,h=!1,p=!1,a=t||{},c=a.userList,e=[],l=null;o.render=function(){for(var t="",n=0;n<e.length;n++)t+=e[n].render();return r.format(u,t)},o.activate=function(){if(!s&&!h){s=!0,l=n(".msame_Drop_AL");for(var t=0;t<e.length;t++){e[t].activate();n(e[t]).on("remove",function(n){return function(){y(n)}}(e[t]))}}},o.deactivate=function(){if(s&&!h){s=!1;for(var t=0;t<e.length;t++)e[t].deactivate(),n(e[t]).off("remove")}},o.dispose=function(){if(!h){o.deactivate();for(var n=0;n<e.length;n++)e[n].dispose();l.remove(),a=t=e=null,l=null,h=!0}},v()}var t=window;t.MSA=t.MSA||{};var i=t.MSA.MeControl=t.MSA.MeControl||{},r=i.Strings,u='<div class="msame_Drop_AL"><div class="msame_Drop_ALItems">{0}<\/div><\/div>';i.AccountsListControl=f}(window.MejQuery),function(n){function e(t){function a(n){n.preventDefault(),n.stopPropagation(),t.onClick&&t.onClick()}var i=this,o=!1,s=!1,c=t,l="msame_si"+f++,h=null,e=null;i.focus=function(){e&&e.focus()},i.render=function(){return r.format(u,l,r.encodeHtml(c.string))},i.activate=function(){if(!o&&!s){o=!0,h=n("#"+l),e=n("a",h);e.on("click",a)}},i.deactivate=function(){o&&!s&&(o=!1,e.off())},i.dispose=function(){s||(i.deactivate(),c=t=null,h=e=null,s=!0)}}var t=window;t.MSA=t.MSA||{};var i=t.MSA.MeControl=t.MSA.MeControl||{},r=i.Strings,u='<div id="{0}" class="msame_Drop_SI"><a href="#" class="msame_TxtTrunc">{1}<\/a><\/div>',f=0;i.SectionItemControl=e}(window.MejQuery),function(n){function o(o){function w(n){n.preventDefault(),n.stopPropagation(),f.logEvent("ViewAccount",{idp:o.idp}),r.location.href=s.accountUrl}var c=this,v=!1,y=!1,s=o,h=null,a=null,p=null,l=null;c.focus=function(){l&&l.focus()},c.render=function(){var h=i.PictureLoaderCache.isCached(s.tileUrl)?s.tileUrl:"",n="",r,f;return o.idp===i.IDP.MSA?(r=i.Loc.lf?s.lastName:s.firstName,f=i.Loc.lf?s.firstName:s.lastName,n=t.format(u,t.encodeHtml(r),t.encodeHtml(f),"name")):n=t.format(u,t.encodeHtml(s.displayName),t.encodeHtml(s.orgName),"email"),t.format(e,h,n,t.encodeHtml(s.memberName),t.getString("viewaccount",!0))},c.activate=function(){if(!v&&!y){v=!0,a=n(".msame_Drop_active"),p=n(".msame_Drop_active_piccont img",a),l=n(".msame_Drop_active_link a",a),h=new i.PictureLoader(p,s.tileUrl,s.errorImgUrl),setTimeout(h.activate,0);l.on("click",w)}},c.deactivate=function(){v&&!y&&(v=!1,h&&h.deactivate(),l.off(),a=p=l=null)},c.dispose=function(){y||(c.deactivate(),h&&(h.dispose(),h=null),s=o=null,p=a=null,y=!0)}}var r=window;r.MSA=r.MSA||{};var i=r.MSA.MeControl=r.MSA.MeControl||{},t=i.Strings,f=i.Log,e='<div class="msame_Drop_active_pic"><div class="msame_Drop_active_piccont"><div class="msame_Drop_active_picframe"><img role="presentation" src="{0}"><\/div><\/div><\/div><div class="msame_Drop_active_right">{1}<div class="msame_TxtTrunc msame_Drop_active_email">{2}<\/div><div class="msame_Drop_active_link"><a href="#">{3}<\/a><\/div><\/div>',u='<div class="msame_TxtTrunc msame_Drop_active_name">{0}<\/div><div class="msame_TxtTrunc msame_Drop_active_{2}">{1}<\/div>';i.ActiveAccountControl=o}(window.MejQuery),function(n){function v(a,v){function ni(){kt&&(it=new t.ActiveAccountControl(a.activeAccountData()),w.push(it),ht=new t.SectionItemControl({string:u.getString("viewaccount"),onClick:function(){r.location.href=a.userStateModel().getIdpInfo().accountSettingsUrl}}),w.push(ht),rt=new t.SectionItemControl({string:u.getString("signout"),onClick:a.signOut}),w.push(rt)),a.isReady()&&a.userStateModel().canSignInOtherAccount()&&(ut=new t.SectionItemControl({string:u.getString("signinotheraccount"),onClick:a.signIn}),w.push(ut))}function pt(){g&&!nt&&(y.toggleClass("msame_Mobile",st),st?at.show():at.hide())}function ti(n){y.toggleClass("msame_ClickStart",!n)}function wt(){if(ft){for(var n=0;n<ft.length;n++)ft[n].dispose();ft=null}}function ii(n){if(!nt){var t=y.height();y.css({top:"-="+o,height:t/2,opacity:"0",display:""}),y.animate({top:"+="+o,height:t+"px"},{duration:l,easing:"easeOutQuintPartial",queue:!1,complete:function(){nt||(y.css("height",""),n&&n())}}),y.animate({opacity:"1"},{duration:s,queue:!1,easing:"linear"})}}function ri(){if(!vt&&(vt=!0,!et&&a.isReady()&&(et=a.userStateModel()),et)){var i=Date.now();et.getUserState(function(r){var u,e;if(r&&r.length>0){b=new t.AccountsListControl({userList:r},a);n(b).on("empty",ui);w.push(b),u=n(".msame_Drop_accts_list",y),u.html(b.render()),b.activate(),e=n(".msame_Drop_accts",y),e.show()}f.logEvent("AccountListReady",{duration:Date.now()-i,count:r&&r.length})},function(){})}}function ui(){var t,i;b&&(t=n(".msame_Drop_accts",y),t.slideUp("fast"),b.dispose(),i=w.indexOf(b),w.splice(i,1),n(b).off("empty"),b=null)}function bt(n,t){try{for(var i=t;i&&i!==n&&i!==tt[0];)i=i.parentNode;return i===n}catch(r){return!1}}function ot(n){nt||!d||!k||n.type==="mousewheel"||n.target===k[0]||bt(k[0],n.target)||bt(y[0],n.target)||(n.preventDefault(),n.stopPropagation(),p.hide())}function fi(n){d&&n.which===27&&p.hide(!0)}var p=this,g=!1,nt=!1,d=!1,kt=a.hasActiveUser(),vt=!1,st=a.mobileState()===t.MobileState.Mobile,w=[],it=null,b=null,ht=null,rt=null,ut=null,ft=null,et=a.userStateModel(),dt,y=null,ct=null,lt=null,at=null,yt=null,k=v&&v.anchor,tt=n(document),gt=n(document.body);p.setMobileState=function(n){st=n===t.MobileState.Mobile,pt()},p.updateExtensibleLinks=function(){var n,i,r;if(ct.hide(),lt.html(""),n=a.extensibleLinks(),n&&n.length>0)for(wt(),ft=[],ct.show(),i=0;i<n.length;i++)r=new t.SectionItemControl(n[i]),lt.append(r.render()),r.activate(),ft.push(r)},p.render=function(){return u.format(h,it?it.render():"",ht?ht.render():"",ut?ut.render():"",rt?rt.render():"")},p.activate=function(){var f,u;if(!g&&!nt){if(f=n("#meControlDropdown"),f.length>0){g=!0,y=f,ct=n(".msame_Drop_links",y),lt=n(".msame_Drop_links_list",y),yt=n(".msame_Drop_topb",y),at=n(".msame_Drop_account",y),t.Browser.ie8&&y.addClass("msaie8");tt.on("click"+i,ot);tt.on("mousedown"+i,ot);tt.on("touchend"+i,ot);tt.on("mousewheel"+i,ot);tt.on("keyup"+i,fi);n(r).on("resize"+i,ot);for(u=0;u<w.length;u++)w[u].activate();ri()}pt(),p.updateExtensibleLinks()}},p.deactivate=function(){if(g&&!nt){g=!1,tt.off(i),n(r).off(i),b&&n(b).off("empty");for(var t=0;t<w.length;t++)w[t].deactivate()}},p.toggle=function(n){g&&(ti(n),d?p.hide():p.show())},p.show=function(){if(g&&!d){if(d=!0,f.logEvent("DropdownOpen"),k){var i=k.offset(),r=gt.offset();i.left-=r.left,i.top-=r.top,y.css({top:i.top+k.height()+"px",left:(t.Loc.rtl?i.left:i.left-y.width()+k.width())+"px"}),yt.css("width",y.width()-k.outerWidth()+c+"px")}ii(function(){var t=st?(y[0].clientWidth-108).toString():"";n(".msame_Drop_AI_right",y).css("width",t),it?it.focus():ut?ut.focus():rt&&rt.focus()}),n(p).trigger(e,{visible:d})}},p.hide=function(t){g&&d&&(d=!1,y.fadeOut(s,function(){t&&k&&k.focus(),n(p).trigger(e,{visible:d})}))},p.dispose=function(){if(!nt){p.deactivate(),wt();for(var n=0;n<w.length;n++)w[n].dispose();y.remove(),a=dt=et=w=null,y=k=tt=null,nt=!0}},ni()}var r=window;r.MSA=r.MSA||{};var t=r.MSA.MeControl=r.MSA.MeControl||{},u=t.Strings,f=t.Log,e="visible",i=".msame",h='<div id="meControlDropdown" class="msame_Drop_root" style="display: none;"><div class="msame_Drop_topb"><\/div><div class="msame_Drop_content"><div class="msame_Drop_active">{0}<\/div><div class="msame_Drop_account" style="display: none;">{1}<\/div><div class="msame_Drop_links" style="display: none;"><div class="msame_Drop_links_list"><\/div><\/div><div class="msame_Drop_signIn">{2}<\/div><div class="msame_Drop_signOut">{3}<\/div><div class="msame_Drop_accts" style="display: none;"><div class="msame_Drop_sep"><\/div><div class="msame_Drop_accts_list"><\/div><\/div><\/div><\/div>',c=2,o=60,l=833,s=100,a=.2;n.extend(n.easing,{easeOutQuintPartial:function(n){return n+=a*(1-n),Math.pow(n-1,5)+1}}),t.MeDropdownControl=v}(window.MejQuery),function(n){function u(){function c(t,i,r){var c,v;if(!e&&t){var y=Date.now(),l="mecontrol_iframe_index_"+s++,a=n('<iframe style="display:none"><\/iframe>').attr("id",l).attr("src",t);a.appendTo("body"),i&&(c=f.getDomainFromUrl(t),u[c]||(u[c]={}),v=setTimeout(function(){h(c,l)},o),u[c][l]={callback:i,iframe:a[0],start:y,timeoutId:v,timeoutCallback:r})}}function l(t){var i=t.originalEvent;i&&u[i.origin]&&n.each(u[i.origin],function(t,f){if(i.source==f.iframe.contentWindow){r.logQos("IFrameCtrl",!0,Date.now()-f.start,"",{src:f.iframe.src});var e=f.callback(i);e?(clearTimeout(f.timeoutId),n(f.iframe).remove(),delete u[i.origin][t]):(clearTimeout(f.timeoutId),f.timeoutId=setTimeout(function(){h(i.origin,t)},o))}})}function h(t,i){if(!e&&u&&u[t]){var r=u[t][i];r&&(r.timeoutCallback&&r.timeoutCallback(),n(r.iframe).remove(),delete u[t][i])}}var o=3e4,f=this,e=!0,s,u;f.init=function(){if(e){u={},s=0,e=!1;n(t).on("message.msame",l)}},f.getDomainFromUrl=function(n){var t=document.createElement("a"),i;return t.href=n,i=t.protocol+"//"+t.hostname,t.port!==null&&t.port!==""&&t.port!=="443"&&t.port!=="80"&&t.port!=="0"&&(i+=":"+t.port),i},f.openIFrame=function(n,t,r,u){u&&(n=i.Util.appendQueryParams(n,u)),c(n,t,r)},f.dispose=function(){var r,i;if(!e){n(t).off("message.msame");for(r in u)for(i in r)clearTimeout(i.timeoutId),n(i.iframe).remove();u=null,e=!0}},f.init();n(t).on("unload.msame",f.dispose)}var t=window,i=t.MSA.MeControl,r=i.Log;i.IFrameControl=new u}(window.MejQuery),function(n){function c(c,l,a,v){function et(){var r,n,i;if(w&&b){for(r=[],n=0;n<w.length;n++)i=!0,w[n].memberName&&b.idp===w[n].idp&&b.memberName===w[n].memberName.toLowerCase()&&(i=!1,b.idp===t.AAD&&(b.sessionId=w[n].sessionId)),w[n].idp===t.ORG_ID&&(i=!1),i&&r.push(w[n]);w=r}}function rt(i){var e,s,u,r,o;return nt&&(e=y.msaInfo.meTrustedOrigin&&i.origin===y.msaInfo.meTrustedOrigin,s=y.aadInfo.meTrustedOrigin&&i.origin===y.aadInfo.meTrustedOrigin,(e||s)&&typeof i.data=="string"&&(d--,u={currentIdp:e?t.MSA:t.AAD,messagesMissing:d},r=n.parseJSON(i.data),r&&r.userList&&r.userList.length>0?k.push.apply(k,r.userList):(o="InvalidIdpData",r&&r.error&&(u.IDPError=r.error,o="IDPError"),f.logQos("UserStatePartial",!1,Date.now()-it,o,u)),d===0))?(k&&k.length>0?g(!0):g(!1,"NoIdpData",u),!0):!1}function g(n,t,i){var r,u;for(w=k||[],et(),i=i||{},i.userCount=w.length,f.logQos("UserState",n,Date.now()-it,t,i),r=0;r<tt.length;r++)u=tt[r],n?u.success(w):u.failure&&u.failure();st()}function ut(){nt&&(d-=1,d===0&&(k&&k.length>0?g(!0,"",{timeout:!0,messagesMissing:d}):g(!1,"Timeout")))}function st(){d=0,nt=!1,it=0,k=[],tt=[]}function ot(){var n=y.msaInfo;return p.isIdpEnabled(t.MSA)&&i.hasQueryParam(n.signOutUrl,"ru")&&i.hasQueryParam(n.signInUrl,"wreply")}var p=this,ft=!1,y=c,b=null,k=[],w=null,tt=[],d=0,nt=!1,it;p.setActiveUser=function(n){b=n,et()},p.currentState=function(){return w||[]},p.getUserState=function(n,i){if(w){n(w);return}if(tt.push({success:n,failure:i}),!nt){if(w=null,it=Date.now(),r.TestData){k=r.TestData,g(!0);return}if(!o.postMessage){g(!1,"PostMessageNotSupported");return}if(location.protocol!=="https:"){g(!1,"HttpNotSupported");return}nt=!0,d=l?2:1;var e={uaid:f.id};y&&y.msaInfo&&y.aadInfo?p.isIdpEnabled(t.MSA)?(y.msaInfo.meTrustedOrigin=u.getDomainFromUrl(y.msaInfo.meUrl),p.isIdpEnabled(t.AAD)?(y.aadInfo.meTrustedOrigin=u.getDomainFromUrl(y.aadInfo.meUrl),u.openIFrame(y.msaInfo.meUrl,rt,ut,e),l&&(e.appId=y.aadInfo.appId,u.openIFrame(y.aadInfo.meUrl,rt,ut,e))):(a&&(e.idpflag=h),u.openIFrame(y.msaInfo.meUrl,rt,ut,e))):p.isIdpEnabled(t.AAD)&&l&&(y.aadInfo.meTrustedOrigin=u.getDomainFromUrl(y.aadInfo.meUrl),a&&(e.idpflag=h),e.appId=y.aadInfo.appId,u.openIFrame(y.aadInfo.meUrl,rt,ut,e)):g(!1,"InvalidRpData")}},p.getIdpInfo=function(n){n=n||b&&b.idp;var i;switch(n){case t.MSA:i=y.msaInfo;break;case t.AAD:i=y.aadInfo;break;case t.MSA_FED:i=y.aadInfo}return i||{}},p.isIdpEnabled=function(n){if(!n)return!1;var t=p.getIdpInfo(n);return!!(t&&t.meUrl)},p.dispose=function(){ft||(ft=!0)},p.getSignInUrl=function(n){var f=b&&b.authenticatedState==r.AuthState.SignedIn;n=n||f&&b.idp||y.preferredIdp||t.MSA;var e=n==t.AAD,o=n==t.MSA,u=e?y.aadInfo:y.msaInfo;return f&&o&&ot()?i.setQueryParam(u.signOutUrl,"ru",encodeURIComponent(u.signInUrl)):u.signInUrl},p.canSignInOtherAccount=function(){var n=b&&b.authenticatedState==r.AuthState.SignedIn;return p.isIdpEnabled(t.AAD)||!n||ot()},p.getSignOutUrl=function(n){var u=n.idp===t.AAD||n.idp===t.MSA_FED,f=u?y.aadInfo:y.msaInfo,r,o,s;return u&&n.sessionId?(o=encodeURIComponent(f.signOutRedirectUrl),s={sessionId:encodeURIComponent(n.sessionId),shouldForgetUser:"false",isIframe:"false",wreply:o},r=i.appendQueryParams(e,s)):r=f.signOutUrl,i.appendContextParam(r)},p.signOutUser=function(i,r,o){var s;if((i.idp===t.AAD||i.idp===t.MSA_FED)&&p.isIdpEnabled(t.AAD)){var l=i,h=y.aadInfo,c={appId:h.appId,sessionId:encodeURIComponent(l.sessionId),shouldForgetUser:"true",isIframe:"true",wreply:encodeURIComponent(h.signOutRedirectUrl)};v&&(c.slice="TestSlice"),s=Date.now(),u.openIFrame(e,function(t){var i=u.getDomainFromUrl(e),o;return t.origin!==i?!1:(o=n.parseJSON(t.data),r(),f.logQos("SignOutUser",!0,Date.now()-s),!0)},function(){o(),f.logQos("SignOutUser",!1,Date.now()-s,"Timeout")},c)}else i.idp===t.MSA&&p.isIdpEnabled(t.MSA)?o&&o():o&&o()},p.getSwitchToUrl=function(n){if(n.idp==t.MSA)return i.appendQueryParams(y.msaInfo.signInUrl,{username:n.memberName});if(n.idp==t.AAD||n.idp==t.MSA_FED){var r=y.aadInfo.signInUrl;return i.hasQueryParam(r,s)&&(r=i.setQueryParam(r,s,"")),r=i.setQueryParam(r,"response_mode","login"),i.setQueryParam(r,"login_hint",n.memberName)}return""}}var o=window,r=o.MSA.MeControl,u=r.IFrameControl,f=r.Log,t=r.IDP,i=r.Util,s="prompt",h="proxy",e="https://login.microsoftonline.com/uxlogout";r.UserStateModel=c}(window.MejQuery);window.MSA.MeControl.Loc={rtl:false,lf:false};window.MSA.MeControl.Strings.addStrings({
"editdone":"Done",
"statussigningout":"Signing out",
"viewaccount":"View account",
"signinotheraccount":"Sign in with another account",
"statusremoving":"Removing from list",
"statussignoutfailed":"Sign-out failed",
"removetip":"Remove from list",
"statussignedin":"Signed in",
"signoutremovetip":"Sign out and remove from list",
"statusunavailable":"Not available",
"editlist":"Edit list",
"account":"Account",
"statusremovingfailed":"Removal failed",
"statussignedout":"Signed out"});window.MSA.MeControl.Loader.scriptLoaded('meCore');